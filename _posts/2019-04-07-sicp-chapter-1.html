---
layout: page
title: SICP Chapter 1 Exercises & Solutions
category: note
tags: 
- post
- SICP
- solutions
---
<style>
.outline-text-3 > p.verse {
    background-color: #eee8d5;
    font: italic 400 1.0em Calibri,-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol" !important;
    padding: 1em;
    padding-left: 1.5em;
    border-left: 3px solid #2aa198;
}
</style>

<section id="outline-container-orgd3540a4" class="outline-2">
<h2 id="orgd3540a4"></h2>
<div class="outline-text-2" id="text-orgd3540a4">
<p>
The HTML for this page has been automatically generated by parsing the loosely
formatted source code &amp; comments included in my solutions repository
(<a href="https://github.com/zv/SICP-guile">https://github.com/zv/SICP-guile</a>), if you encounter any unformatted
solutions, you think you've spotted an error or you have something you'd like
to share about the exercises, don't hesitate to leave a comment below
(or a pull request on the source repo).
</p>
</div>
</section>

<section id="outline-container-orgb00ec7a" class="outline-2">
<h2 id="orgb00ec7a">Exercises Chapter 1</h2>
<div class="outline-text-2" id="text-orgb00ec7a">
</div>
<div id="outline-container-orgc78c0a4" class="outline-3">
<h3 id="orgc78c0a4">1.1</h3>
<div class="outline-text-3" id="text-orgc78c0a4">
<p class="verse">
Below is a sequence of expressions. What is the result printed by the<br>
interpreter in response to each expression? Assume that the sequence is to be<br>
evaluated in the order in which it is presented.<br>
<br>
(Expressions Contained in Answer Section)<br>
</p>
</div>

<div id="outline-container-orged30376" class="outline-4">
<h4 id="orged30376">Answer</h4>
<div class="outline-text-4" id="text-orged30376">
<blockquote>
<p>
Respectively:
</p>

<p>
10
scheme@(guile-user)&gt; 10
</p>

<p>
(+ 5 3 4)
scheme@(guile-user)&gt; 12
</p>

<p>
(- 9 1)
scheme@(guile-user)&gt; 8
</p>

<p>
(/ 6 2)
scheme@(guile-user)&gt; 3
</p>

<p>
(+ (* 2 4) (- 4 6))
scheme@(guile-user)&gt; 6
</p>

<p>
(define a 3)
(define b (+ a 1))
(+ a b (* a b))
scheme@(guile-user)&gt; 19
</p>

<p>
(= a b)
scheme@(guile-user)&gt; #f
</p>

<p>
(if (and (&gt; b a) (&lt; b (* a b)))
    b
    a)
scheme@(guile-user)&gt; 4
</p>

<p>
(cond ((= a 4) 6)
      ((= b 4) (+ 6 7 a))
      (else 25))
scheme@(guile-user)&gt; 16
</p>

<p>
(+ 2 (if (&gt; b a) b a))
scheme@(guile-user)&gt; 6
</p>

<p>
(* (cond ((&gt; a b) a)
         ((&lt; a b) b)
         (else -1))
   (+ a 1))
scheme@(guile-user)&gt; 16
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-org85064fe" class="outline-3">
<h3 id="org85064fe">1.2</h3>
<div class="outline-text-3" id="text-org85064fe">
<p class="verse">
Translate the following expression into prefix form.<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;5 + 4 + (2 - (3 - (6 + 4/5)))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;------------------------&#x2013;&#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;3(6 - 2)(2 - 7)<br>
</p>
</div>

<div id="outline-container-orgbb5f2eb" class="outline-4">
<h4 id="orgbb5f2eb">Answer</h4>
<div class="outline-text-4" id="text-orgbb5f2eb">
<p class="verse">
(/ (+ (+ 5 4) (- 2 (- 3 (+ 6 (/ 4 5))))) (* 3 (- 6 2) (- 2 7)))<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org8777e09" class="outline-3">
<h3 id="org8777e09">1.3</h3>
<div class="outline-text-3" id="text-org8777e09">
<p class="verse">
Define a procedure that takes three numbers as arguments and returns the sum of<br>
the squares of the two larger numbers.<br>
</p>
</div>

<div id="outline-container-orga4c57ab" class="outline-4">
<h4 id="orga4c57ab">Answer</h4>
<div class="outline-text-4" id="text-orga4c57ab">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">largest-squares</span> x y z<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>+
   <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>&gt; x y<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>square x<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>square y<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
   <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>&gt; y z<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>square y<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>square z<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org01409f8" class="outline-3">
<h3 id="org01409f8">1.4</h3>
<div class="outline-text-3" id="text-org01409f8">
<p class="verse">
Observe that our model of evaluation allows for combinations whose operators are<br>
compound expressions. Use this observation to describe the behavior of the<br>
following procedure:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (a-plus-abs-b a b)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;((if (&gt; b 0) + -) a b))<br>
</p>
</div>

<div id="outline-container-org3f7b580" class="outline-4">
<h4 id="org3f7b580">Answer</h4>
<div class="outline-text-4" id="text-org3f7b580">
<blockquote>
<p>
If b is greater than 0, add a to b.
Otherwise, subtract b from a
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-org8eedc0a" class="outline-3">
<h3 id="org8eedc0a">1.5</h3>
<div class="outline-text-3" id="text-org8eedc0a">
<p class="verse">
Ben Bitdiddle has invented a test to determine whether the interpreter he is<br>
faced with is using applicative-order evaluation or normal-order evaluation. He<br>
defines the following two procedures:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (p) (p))<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (test x y)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(if (= x 0)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;0<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;y))<br>
<br>
Then he evaluates the expression<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(test 0 (p))<br>
<br>
What behavior will Ben observe with an interpreter that uses applicative-order<br>
evaluation? What behavior will he observe with an interpreter that uses<br>
normal-order evaluation? Explain your answer. (Assume that the evaluation rule<br>
for the special form `if' is the same whether the interpreter is using normal or<br>
applicative order: The predicate expression is evaluated first, and the result<br>
determines whether to evaluate the consequent or the alternative expression.)<br>
</p>
</div>

<div id="outline-container-org9da1dc5" class="outline-4">
<h4 id="org9da1dc5">Answer</h4>
<div class="outline-text-4" id="text-org9da1dc5">
<p class="verse">
An applicative order evaluator would never terminate. The value of `p' is<br>
expanded prior to the logic of `test' being applied.<br>
<br>
Conversely, a normal-order evaluator would return 0, it never had the chance to<br>
expand `p'<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org6ee9d40" class="outline-3">
<h3 id="org6ee9d40">1.6</h3>
<div class="outline-text-3" id="text-org6ee9d40">
<p class="verse">
Alyssa P. Hacker doesn't see why `if' needs to be provided as a special form.<br>
"Why can't I just define it as an ordinary procedure in terms of `cond'?" she<br>
asks. Alyssa's friend Eva Lu Ator claims this can indeed be done, and she<br>
defines a new version of `if':<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (new-if predicate then-clause else-clause)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(cond (predicate then-clause)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(else else-clause)))<br>
<br>
Eva demonstrates the program for Alyssa:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(new-if (= 2 3) 0 5)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;5<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(new-if (= 1 1) 0 5)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;0<br>
<br>
Delighted, Alyssa uses `new-if' to rewrite the square-root program:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (sqrt-iter guess x)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(new-if (good-enough? guess x)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;guess<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(sqrt-iter (improve guess x)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;x)))<br>
<br>
What happens when Alyssa attempts to use this to compute square<br>
roots?  Explain.<br>
</p>
</div>

<div id="outline-container-orgae412ad" class="outline-4">
<h4 id="orgae412ad">Answer</h4>
<div class="outline-text-4" id="text-orgae412ad">
<blockquote>
<p>
Any function supplied to `new-if' will be applied, `sqrt-iter' will thus infinitely loop.
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-orgee1ccae" class="outline-3">
<h3 id="orgee1ccae">1.7</h3>
<div class="outline-text-3" id="text-orgee1ccae">
<p class="verse">
The `good-enough?' test used in computing square roots will not be very<br>
effective for finding the square roots of very small numbers. Also, in real<br>
computers, arithmetic operations are almost always performed with limited<br>
precision. This makes our test inadequate for very large numbers. Explain these<br>
statements, with quotes showing how the test fails for small and large<br>
numbers.<br>
<br>
An alternative strategy for implementing `good-enough?' is to watch how<br>
`guess' changes from one iteration to the next and to stop when the change<br>
is a very small fraction of the guess. Design a square-root procedure that<br>
uses this kind of end test. Does this work better for small and large<br>
numbers?<br>
</p>
</div>

<div id="outline-container-orgb32383d" class="outline-4">
<h4 id="orgb32383d">Answer</h4>
<div class="outline-text-4" id="text-orgb32383d">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">fix/sqrt-iter</span> guess last-guess x<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">[</span>good-enough? <span style="color: #859900;">(</span>&lt; <span style="color: #b58900;">(</span>abs <span style="color: #268bd2;">(</span>- guess last-guess<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span> <span style="color: #6c71c4;">0.001</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span>
        <span style="color: #6c71c4;">[</span>next-guess <span style="color: #859900;">(</span>average guess <span style="color: #b58900;">(</span>/ x guess<span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span><span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> good-enough? guess
        <span style="color: #6c71c4;">(</span>fix/sqrt-iter next-guess guess x<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc514cf3" class="outline-3">
<h3 id="orgc514cf3">1.8</h3>
<div class="outline-text-3" id="text-orgc514cf3">
<p class="verse">
Newton's method for cube roots is based on the fact that if y is an<br>
approximation to the cube root of x, then a better approximation is given<br>
by the value<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;x/y<sup>2</sup> + 2y<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;-----&#x2013;&#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;3<br>
<br>
Use this formula to implement a cube-root procedure analogous to the<br>
square-root procedure. (In section 1.3.4 we will see how to implement<br>
Newton's method in general as an abstraction of these square-root and<br>
cube-root procedures.)<br>
</p>
</div>

<div id="outline-container-org6675bbe" class="outline-4">
<h4 id="org6675bbe">Answer</h4>
<div class="outline-text-4" id="text-org6675bbe">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.8/sqrt-iter</span> guess last-guess x<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">[</span>good-enough? <span style="color: #859900;">(</span>&lt; <span style="color: #b58900;">(</span>abs <span style="color: #268bd2;">(</span>- guess last-guess<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span> <span style="color: #6c71c4;">0.001</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span>
        <span style="color: #6c71c4;">[</span>next-guess <span style="color: #859900;">(</span>/ <span style="color: #b58900;">(</span>+ <span style="color: #268bd2;">(</span>/ x <span style="color: #6c71c4;">(</span>square guess<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
                       <span style="color: #268bd2;">(</span>* <span style="color: #6c71c4;">2</span> guess<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
                    <span style="color: #6c71c4;">3</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span><span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> good-enough? guess
        <span style="color: #6c71c4;">(</span>fix/sqrt-iter next-guess guess x<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga43b6e5" class="outline-3">
<h3 id="orga43b6e5">1.9</h3>
<div class="outline-text-3" id="text-orga43b6e5">
<p class="verse">
Each of the following two procedures defines a method for adding two<br>
positive integers in terms of the procedures `inc', which increments its<br>
argument by 1, and `dec', which decrements its argument by 1.<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (+ a b)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(if (= a 0)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;b<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(inc (+ (dec a) b))))<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (+ a b)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(if (= a 0)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;b<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(+ (dec a) (inc b))))<br>
<br>
Using the substitution model, illustrate the process generated by each<br>
procedure in evaluating `(+ 4 5)'. Are these processes iterative or<br>
recursive?<br>
</p>
</div>

<div id="outline-container-org0e76be0" class="outline-4">
<h4 id="org0e76be0">Answer</h4>
<div class="outline-text-4" id="text-org0e76be0">
<p class="verse">
<br>
The first is recursive:<br>
<br>
&#xa0;&#xa0;scheme@(guile-user)&gt; ,trace (+ 4 5)<br>
<br>
&#xa0;&#xa0;trace: |  (+ 4 5)<br>
&#xa0;&#xa0;trace: |  |  (+ 3 5)<br>
&#xa0;&#xa0;trace: |  |  |  (+ 2 5)<br>
&#xa0;&#xa0;trace: |  |  |  |  (+ 1 5)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  (+ 0 5)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  5<br>
&#xa0;&#xa0;trace: |  |  |  |  6<br>
&#xa0;&#xa0;trace: |  |  |  7<br>
&#xa0;&#xa0;trace: |  |  8<br>
&#xa0;&#xa0;trace: |  9<br>
<br>
The second function is iterative<br>
<br>
&#xa0;&#xa0;scheme@(guile-user)&gt; ,trace (pl 4 5)<br>
&#xa0;&#xa0;trace: |  (pl 4 5)<br>
&#xa0;&#xa0;trace: |  |  (dec 4)<br>
&#xa0;&#xa0;trace: |  |  3<br>
&#xa0;&#xa0;trace: |  |  (inc 5)<br>
&#xa0;&#xa0;trace: |  |  6<br>
&#xa0;&#xa0;trace: |  (pl 3 6)<br>
&#xa0;&#xa0;trace: |  |  (dec 3)<br>
&#xa0;&#xa0;trace: |  |  2<br>
&#xa0;&#xa0;trace: |  |  (inc 6)<br>
&#xa0;&#xa0;trace: |  |  7<br>
&#xa0;&#xa0;trace: |  (pl 2 7)<br>
&#xa0;&#xa0;trace: |  |  (dec 2)<br>
<br>
&#xa0;&#xa0;trace: |  |  1<br>
&#xa0;&#xa0;trace: |  |  (inc 7)<br>
&#xa0;&#xa0;trace: |  |  8<br>
&#xa0;&#xa0;trace: |  (pl 1 8)<br>
&#xa0;&#xa0;trace: |  |  (dec 1)<br>
&#xa0;&#xa0;trace: |  |  0<br>
&#xa0;&#xa0;trace: |  |  (inc 8)<br>
&#xa0;&#xa0;trace: |  |  9<br>
&#xa0;&#xa0;trace: |  (pl 0 9)<br>
&#xa0;&#xa0;trace: |  9<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org816045d" class="outline-3">
<h3 id="org816045d">1.10</h3>
<div class="outline-text-3" id="text-org816045d">
<p class="verse">
The following procedure computes a mathematical function called Ackermann's<br>
function.<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (A x y)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(cond ((= y 0) 0)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;((= x 0) (* 2 y))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;((= y 1) 2)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(else (A (- x 1)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(A x (- y 1))))))<br>
<br>
What are the values of the following expressions?<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(A 1 10)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(A 2 4)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(A 3 3)<br>
<br>
Consider the following procedures, where A is the procedure defined above:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (f n) (A 0 n))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (g n) (A 1 n))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (h n) (A 2 n))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (k n) (* 5 n n))<br>
<br>
Give concise mathematical definitions for the functions computed by the<br>
procedures f, g, and h for positive integer values of n. For quote, (k n)<br>
computes 5n<sup>2</sup>.<br>
</p>
</div>

<div id="outline-container-orgb2d1cee" class="outline-4">
<h4 id="orgb2d1cee">Answer</h4>
<div class="outline-text-4" id="text-orgb2d1cee">
<p class="verse">
<br>
A trace of the first Ackermann function shown produces a long list of<br>
recursive calls, which is only exaggerated as `x' increases.<br>
<br>
&#xa0;&#xa0;scheme@(guile-user)&gt; ,trace (A 1 10)<br>
&#xa0;&#xa0;trace: |  (A 1 10)<br>
&#xa0;&#xa0;trace: |  |  (A 1 9)<br>
&#xa0;&#xa0;trace: |  |  |  (A 1 8)<br>
&#xa0;&#xa0;trace: |  |  |  |  (A 1 7)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  (A 1 6)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  (A 1 5)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  (A 1 4)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  |  (A 1 3)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  |  |  (A 1 2)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  |  |  |  (A 1 1)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  |  |  |  2<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  |  |  (A 0 2)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  |  |  4<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  |  (A 0 4)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  |  8<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  (A 0 8)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  |  16<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  (A 0 16)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  |  32<br>
&#xa0;&#xa0;trace: |  |  |  |  |  (A 0 32)<br>
&#xa0;&#xa0;trace: |  |  |  |  |  64<br>
&#xa0;&#xa0;trace: |  |  |  |  (A 0 64)<br>
&#xa0;&#xa0;trace: |  |  |  |  128<br>
&#xa0;&#xa0;trace: |  |  |  (A 0 128)<br>
&#xa0;&#xa0;trace: |  |  |  256<br>
&#xa0;&#xa0;trace: |  |  (A 0 256)<br>
&#xa0;&#xa0;trace: |  |  512<br>
&#xa0;&#xa0;trace: |  (A 0 512)<br>
&#xa0;&#xa0;trace: |  1024<br>
&#xa0;&#xa0;scheme@(guile-user)&gt; (A 2 4)<br>
&#xa0;&#xa0;$2 = 65536<br>
&#xa0;&#xa0;scheme@(guile-user)&gt; (A 3 3)<br>
&#xa0;&#xa0;$3 = 65536<br>
<br>
<br>
The functions described can be simplified as follows:<br>
<br>
&#xa0;&#xa0;(define (f n) (A 0 n))<br>
&#xa0;&#xa0;→  2n<br>
<br>
&#xa0;&#xa0;(define (g n) (A 1 n))<br>
&#xa0;&#xa0;→  n²<br>
<br>
&#xa0;&#xa0;(define (h n) (A 2 n))<br>
&#xa0;&#xa0;→  2↑n<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org1550ce5" class="outline-3">
<h3 id="org1550ce5">1.11</h3>
<div class="outline-text-3" id="text-org1550ce5">
<p class="verse">
A function f is defined by the rule that<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;f(n) = n if n &lt; 3<br>
<br>
and<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;f(n) = f(n - 1) + 2f(n - 2) + 3f(n - 3) if n &gt;= 3.<br>
<br>
Write a procedure that computes f by means of a recursive process.<br>
Write a procedure that computes f by means of an iterative process.<br>
</p>
</div>

<div id="outline-container-orgc87b172" class="outline-4">
<h4 id="orgc87b172">Answer</h4>
<div class="outline-text-4" id="text-orgc87b172">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">rule1.11/recursive</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>&lt; n <span style="color: #6c71c4;">3</span><span style="color: #268bd2;">)</span> n
      <span style="color: #268bd2;">(</span>+ <span style="color: #6c71c4;">(</span>rule1.11/recursive <span style="color: #859900;">(</span>- n <span style="color: #6c71c4;">1</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span>
         <span style="color: #6c71c4;">(</span>* <span style="color: #6c71c4;">2</span> <span style="color: #859900;">(</span>rule1.11/recursive <span style="color: #b58900;">(</span>- n <span style="color: #6c71c4;">2</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span>
         <span style="color: #6c71c4;">(</span>* <span style="color: #6c71c4;">3</span> <span style="color: #859900;">(</span>rule1.11/recursive <span style="color: #b58900;">(</span>- n <span style="color: #6c71c4;">3</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">rule1.11/iterative</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">driver</span> count a b c<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>= count n<span style="color: #6c71c4;">)</span> c
        <span style="color: #6c71c4;">(</span>driver <span style="color: #859900;">(</span>+ count <span style="color: #6c71c4;">1</span><span style="color: #859900;">)</span>
                       <span style="color: #859900;">(</span>+ a <span style="color: #b58900;">(</span>* <span style="color: #6c71c4;">2</span> b<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>* <span style="color: #6c71c4;">3</span> c<span style="color: #b58900;">)</span><span style="color: #859900;">)</span>
                       a
                       b<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>driver <span style="color: #6c71c4;">0</span> <span style="color: #6c71c4;">2</span> <span style="color: #6c71c4;">1</span> <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga6c0651" class="outline-3">
<h3 id="orga6c0651">1.12</h3>
<div class="outline-text-3" id="text-orga6c0651">
<p class="verse">
The following pattern of numbers is called "Pascal's triangle".<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;1<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;1   1<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;1   2   1<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;1   3   3   1<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;1   4   6   4   1<br>
<br>
The numbers at the edge of the triangle are all 1, and each number inside<br>
the triangle is the sum of the two numbers above it. Write a procedure that<br>
computes elements of Pascal's triangle by means of a recursive process.<br>
</p>
</div>

<div id="outline-container-org6cd3eb5" class="outline-4">
<h4 id="org6cd3eb5">Answer</h4>
<div class="outline-text-4" id="text-org6cd3eb5">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">pascals-triangle</span> depth<span style="color: #b58900;">)</span>
  <span style="color: #93a1a1;">;; </span><span style="color: #93a1a1;">`build-entry' doesn't memoize the finding of each number. You could do</span>
  <span style="color: #93a1a1;">;; </span><span style="color: #93a1a1;">so either here or with more changes to `build-row'.</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">build-entry</span> rows col<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">cond</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">and</span> <span style="color: #b58900;">(</span>= rows <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>= col <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span> <span style="color: #6c71c4;">1</span><span style="color: #6c71c4;">]</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">or</span> <span style="color: #b58900;">(</span>&lt; col <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>&lt; rows col<span style="color: #b58900;">)</span><span style="color: #859900;">)</span> <span style="color: #6c71c4;">0</span><span style="color: #6c71c4;">]</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900; font-weight: bold;">else</span> <span style="color: #859900;">(</span>+ <span style="color: #b58900;">(</span>build-entry <span style="color: #268bd2;">(</span>- rows <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>- col <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
              <span style="color: #b58900;">(</span>build-entry <span style="color: #268bd2;">(</span>- rows <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span> col<span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">build-row</span> ctr length<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>= ctr <span style="color: #859900;">(</span>1+ length<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span> '<span style="color: #6c71c4;">()</span>
        <span style="color: #6c71c4;">(</span>cons <span style="color: #859900;">(</span>build-entry length ctr<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>build-row <span style="color: #b58900;">(</span>+ ctr <span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span> length<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">build</span> n<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>= n depth<span style="color: #6c71c4;">)</span> '<span style="color: #6c71c4;">()</span>
        <span style="color: #6c71c4;">(</span>cons <span style="color: #859900;">(</span>build-row <span style="color: #6c71c4;">0</span> n<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>build <span style="color: #b58900;">(</span>1+ n<span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

  <span style="color: #b58900;">(</span>build <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org75e3531" class="outline-3">
<h3 id="org75e3531">1.13</h3>
<div class="outline-text-3" id="text-org75e3531">
</div>
<div id="outline-container-org04f4898" class="outline-4">
<h4 id="org04f4898">Answer</h4>
</div>
</div>
<div id="outline-container-org484260b" class="outline-3">
<h3 id="org484260b">1.14</h3>
<div class="outline-text-3" id="text-org484260b">
<p class="verse">
Draw the tree illustrating the process generated by the `count-change'<br>
procedure of section *Note 1.2.2 in making change for 11 cents. What are<br>
the orders of growth of the space and number of steps used by this process<br>
as the amount to be changed increases?<br>
</p>
</div>

<div id="outline-container-org9a21826" class="outline-4">
<h4 id="org9a21826">Answer</h4>
<div class="outline-text-4" id="text-org9a21826">
<p class="verse">
trace: (count-change 11)<br>
trace: (cc 11 5)<br>
trace: |  (cc 11 4)<br>
trace: |  |  (cc 11 3)<br>
trace: |  |  |  (cc 11 2)<br>
trace: |  |  |  |  (cc 11 1)<br>
trace: |  |  |  |  |  (cc 11 0)<br>
trace: |  |  |  |  |  0<br>
trace: |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  1<br>
trace: |  |  |  |  |  (cc 10 1)<br>
trace: |  |  |  |  |  |  (cc 10 0)<br>
trace: |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  (cc 9 1)<br>
trace: |  |  |  |  |  |  |  (cc 9 0)<br>
trace: |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  (cc 8 1)<br>
trace: |  |  |  |  |  |  |  |  (cc 8 0)<br>
trace: |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  (cc 7 1)<br>
trace: |  |  |  |  |  |  |  |  |  (cc 7 0)<br>
trace: |  |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  (cc 6 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  (cc 6 0)<br>
trace: |  |  |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  (cc 5 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  (cc 5 0)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  (cc 4 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  (cc 4 0)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  (cc 3 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  (cc 3 0)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  (cc 2 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  15&gt; (cc 2 0)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  15&lt; 0<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  15&gt; (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  15&lt; 1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  15&gt; (cc 1 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  16&gt; (cc 1 0)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  16&lt; 0<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  16&gt; (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  16&lt; 1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  16&gt; (cc 0 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  16&lt; 1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  15&lt; 1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  1<br>
trace: |  |  |  |  1<br>
trace: |  |  |  |  (first-denomination 2)<br>
trace: |  |  |  |  5<br>
trace: |  |  |  |  (cc 6 2)<br>
trace: |  |  |  |  |  (cc 6 1)<br>
trace: |  |  |  |  |  |  (cc 6 0)<br>
trace: |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  (cc 5 1)<br>
trace: |  |  |  |  |  |  |  (cc 5 0)<br>
trace: |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  (cc 4 1)<br>
trace: |  |  |  |  |  |  |  |  (cc 4 0)<br>
trace: |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  (cc 3 1)<br>
trace: |  |  |  |  |  |  |  |  |  (cc 3 0)<br>
trace: |  |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  (cc 2 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  (cc 2 0)<br>
trace: |  |  |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  (cc 1 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  (cc 1 0)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  |  (cc 0 1)<br>
trace: |  |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  1<br>
trace: |  |  |  |  |  (first-denomination 2)<br>
trace: |  |  |  |  |  5<br>
trace: |  |  |  |  |  (cc 1 2)<br>
trace: |  |  |  |  |  |  (cc 1 1)<br>
trace: |  |  |  |  |  |  |  (cc 1 0)<br>
trace: |  |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  |  (cc 0 1)<br>
trace: |  |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  (first-denomination 2)<br>
trace: |  |  |  |  |  |  5<br>
trace: |  |  |  |  |  |  (cc -4 2)<br>
trace: |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  1<br>
trace: |  |  |  |  2<br>
trace: |  |  |  3<br>
trace: |  |  |  (first-denomination 3)<br>
trace: |  |  |  10<br>
trace: |  |  |  (cc 1 3)<br>
trace: |  |  |  |  (cc 1 2)<br>
trace: |  |  |  |  |  (cc 1 1)<br>
trace: |  |  |  |  |  |  (cc 1 0)<br>
trace: |  |  |  |  |  |  0<br>
trace: |  |  |  |  |  |  (first-denomination 1)<br>
trace: |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  |  (cc 0 1)<br>
trace: |  |  |  |  |  |  1<br>
trace: |  |  |  |  |  1<br>
trace: |  |  |  |  |  (first-denomination 2)<br>
trace: |  |  |  |  |  5<br>
trace: |  |  |  |  |  (cc -4 2)<br>
trace: |  |  |  |  |  0<br>
trace: |  |  |  |  1<br>
trace: |  |  |  |  (first-denomination 3)<br>
trace: |  |  |  |  10<br>
trace: |  |  |  |  (cc -9 3)<br>
trace: |  |  |  |  0<br>
trace: |  |  |  1<br>
trace: |  |  4<br>
trace: |  |  (first-denomination 4)<br>
trace: |  |  25<br>
trace: |  |  (cc -14 4)<br>
trace: |  |  0<br>
trace: |  4<br>
trace: |  (first-denomination 5)<br>
trace: |  50<br>
trace: |  (cc -39 5)<br>
trace: |  0<br>
trace: 4<br>
</p>
</div>
</div>
</div>
<div id="outline-container-orgd7bf083" class="outline-3">
<h3 id="orgd7bf083">1.15</h3>
<div class="outline-text-3" id="text-orgd7bf083">
<p class="verse">
The sine of an angle (specified in radians) can be computed by making use<br>
of the approximation `sin' xapprox x if x is sufficiently small, and the<br>
trigonometric identity<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;x             x<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;sin x = 3 sin &#x2014; - 4 sin<sup>3</sup> &#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;3             3<br>
<br>
to reduce the size of the argument of `sin'. (For purposes of this<br>
exercise an angle is considered "sufficiently small" if its magnitude is<br>
not greater than 0.1 radians.) These ideas are incorporated in the<br>
following procedures:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (cube x) (* x x x))<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (p x) (- (* 3 x) (* 4 (cube x))))<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (sine angle)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(if (not (&gt; (abs angle) 0.1))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;angle<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(p (sine (/ angle 3.0)))))<br>
<br>
a. How many times is the procedure `p' applied when `(sine 12.15)' is<br>
evaluated?<br>
<br>
b. What is the order of growth in space and number of steps (as a function<br>
of a) used by the process generated by the `sine' procedure when `(sine a)'<br>
is evaluated?<br>
</p>
</div>

<div id="outline-container-org8b22571" class="outline-4">
<h4 id="org8b22571">Answer</h4>
<div class="outline-text-4" id="text-org8b22571">
<blockquote>
<p>
a. The procedure is evaluated 5 times
b. The order of growth is O(log(n))
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-org4cdca19" class="outline-3">
<h3 id="org4cdca19">1.16</h3>
<div class="outline-text-3" id="text-org4cdca19">
<p class="verse">
Design a procedure that evolves an iterative exponentiation process that<br>
uses successive squaring and uses a logarithmic number of steps, as does<br>
`fast-expt'.<br>
<br>
(Hint: Using the observation that (bⁿ/²)²= (b²)ⁿ/², keep, along with the<br>
exponent `n' and the base `b', an additional state variable `a', and define<br>
the state transformation in such a way that the product abⁿ is unchanged<br>
from state to state. At the beginning of the process a is taken to be 1,<br>
and the answer is given by the value of `a' at the end of the process. In<br>
general, the technique of defining an "invariant quantity" that remains<br>
unchanged from state to state is a powerful way to think about the design<br>
of iterative algorithms.)<br>
</p>
</div>

<div id="outline-container-orgf202a2b" class="outline-4">
<h4 id="orgf202a2b">Answer</h4>
<div class="outline-text-4" id="text-orgf202a2b">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">zv/expt-iter</span> b n a<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">cond</span>
   <span style="color: #268bd2;">[</span><span style="color: #6c71c4;">(</span>= n <span style="color: #6c71c4;">0</span><span style="color: #6c71c4;">)</span> a<span style="color: #268bd2;">]</span>
   <span style="color: #268bd2;">[</span><span style="color: #6c71c4;">(</span>even? n<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>zv/expt-iter <span style="color: #859900;">(</span>* b b<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>/ n <span style="color: #6c71c4;">2</span><span style="color: #859900;">)</span> a<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">]</span>
   <span style="color: #268bd2;">[</span><span style="color: #859900; font-weight: bold;">else</span>      <span style="color: #6c71c4;">(</span>zv/expt-iter  b <span style="color: #859900;">(</span>- n <span style="color: #6c71c4;">1</span><span style="color: #859900;">)</span> <span style="color: #859900;">(</span>* a b<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf5492cf" class="outline-3">
<h3 id="orgf5492cf">1.17</h3>
<div class="outline-text-3" id="text-orgf5492cf">
<p class="verse">
The exponentiation algorithms in this section are based on performing<br>
exponentiation by means of repeated multiplication. In a similar way, one<br>
can perform integer multiplication by means of repeated addition. The<br>
following multiplication procedure (in which it is assumed that our<br>
language can only add, not multiply) is analogous to the `expt' procedure:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (* a b)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(if (= b 0)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;0<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(+ a (* a (- b 1)))))<br>
<br>
This algorithm takes a number of steps that is linear in `b'. Now suppose<br>
we include, together with addition, operations `double', which doubles an<br>
integer, and `halve', which divides an (even) integer by 2. Using these,<br>
design a multiplication procedure analogous to `fast-expt' that uses a<br>
logarithmic number of steps.<br>
</p>
</div>

<div id="outline-container-org72b5f1e" class="outline-4">
<h4 id="org72b5f1e">Answer</h4>
<div class="outline-text-4" id="text-org72b5f1e">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.17/fast-*</span> a b<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">double</span> x<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>+ x x<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">halve</span> x<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>/ x <span style="color: #6c71c4;">2</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">cond</span> <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span>= b <span style="color: #6c71c4;">0</span><span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">0</span><span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span>even? b<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>double <span style="color: #859900;">(</span>* a <span style="color: #b58900;">(</span>halve b<span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">else</span> <span style="color: #6c71c4;">(</span>+ a <span style="color: #859900;">(</span>* a <span style="color: #b58900;">(</span>- b <span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9fa3e32" class="outline-3">
<h3 id="org9fa3e32">1.18</h3>
<div class="outline-text-3" id="text-org9fa3e32">
</div>
<div id="outline-container-org0e21dee" class="outline-4">
<h4 id="org0e21dee">Answer</h4>
</div>
</div>
<div id="outline-container-org6787414" class="outline-3">
<h3 id="org6787414">1.19</h3>
<div class="outline-text-3" id="text-org6787414">
<p class="verse">
There is a clever algorithm for computing the Fibonacci numbers in a<br>
logarithmic number of steps. Recall the transformation of the state<br>
variables a and b in the fib-iter process of 1.2.2: a ← a + b and b ← a.<br>
Call this transformation T, and observe that applying T over and over again<br>
n times, starting with 1 and 0, produces the pair Fib(n + 1) and Fib(n) .<br>
In other words, the Fibonacci numbers are produced by applying T n, the<br>
n-th power of the transformation T, starting with the pair (1, 0). Now<br>
consider T to be the special case of p = 0 and q = 1 in a family of<br>
transformations T<sub>pq</sub> , where T<sub>pq</sub> transforms the pair(a, b) according to a<br>
← bq + aq + ap and b ← bp + aq .<br>
<br>
Show that if we apply such a transformation T<sub>pq</sub> twice, the effect is the<br>
same as using a single transformation T<sub>p</sub>′q′ of the same form, and compute<br>
p′ and q′ in terms of p and q .<br>
<br>
This gives us an explicit way to square these transformations, and thus we<br>
can compute T n using successive squaring, as in the fast-expt procedure.<br>
<br>
Put this all together to complete the following procedure, which runs in a<br>
logarithmic number of steps:<br>
</p>
</div>

<div id="outline-container-org177dda0" class="outline-4">
<h4 id="org177dda0">Answer</h4>
<div class="outline-text-4" id="text-org177dda0">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.19/fib</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>1.19/fib-iter <span style="color: #6c71c4;">1</span> <span style="color: #6c71c4;">0</span> <span style="color: #6c71c4;">0</span> <span style="color: #6c71c4;">1</span> n<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.19/fib-iter</span> a b p q count<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">cond</span> <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span>= count <span style="color: #6c71c4;">0</span><span style="color: #6c71c4;">)</span> b<span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span>even? count<span style="color: #6c71c4;">)</span>
         <span style="color: #6c71c4;">(</span>1.19/fib-iter a
                   b
                   <span style="color: #859900;">(</span>+ <span style="color: #b58900;">(</span>square p<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>square q<span style="color: #b58900;">)</span><span style="color: #859900;">)</span> <span style="color: #93a1a1;">; </span><span style="color: #93a1a1;">compute p'</span>
                   <span style="color: #859900;">(</span>+ <span style="color: #b58900;">(</span>* <span style="color: #6c71c4;">2</span> p q<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>square q<span style="color: #b58900;">)</span><span style="color: #859900;">)</span>  <span style="color: #93a1a1;">; </span><span style="color: #93a1a1;">compute q'</span>
                   <span style="color: #859900;">(</span>/ count <span style="color: #6c71c4;">2</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">else</span> <span style="color: #6c71c4;">(</span>1.19/fib-iter <span style="color: #859900;">(</span>+ <span style="color: #b58900;">(</span>* b q<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>* a q<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>* a p<span style="color: #b58900;">)</span><span style="color: #859900;">)</span>
                        <span style="color: #859900;">(</span>+ <span style="color: #b58900;">(</span>* b p<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>* a q<span style="color: #b58900;">)</span><span style="color: #859900;">)</span>
                        p
                        q
                        <span style="color: #859900;">(</span>- count <span style="color: #6c71c4;">1</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
<span style="color: #93a1a1;">;; </span><span style="color: #cc9393;">TODO</span><span style="color: #93a1a1;"> </span><span style="color: #cc9393;">XXX</span><span style="color: #93a1a1;"> write test</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8edc74e" class="outline-3">
<h3 id="org8edc74e">1.20</h3>
<div class="outline-text-3" id="text-org8edc74e">
<p class="verse">
The process that a procedure generates is of course dependent on the rules<br>
used by the interpreter. As an quote, consider the iterative `gcd'<br>
procedure given above. Suppose we were to interpret this procedure using<br>
normal-order evaluation, as discussed in section *Note 1-1-5. (The<br>
normal-order-evaluation rule for `if' is described in *Note Exercise 1-5)<br>
Using the substitution method (for normal order), illustrate the process<br>
generated in evaluating `(gcd 206 40)' and indicate the `remainder'<br>
operations that are actually performed. How many `remainder' operations are<br>
actually performed in the normal-order evaluation of `(gcd 206 40)'? In the<br>
applicative-order evaluation?<br>
</p>
</div>

<div id="outline-container-org5e02738" class="outline-4">
<h4 id="org5e02738">Answer</h4>
<div class="outline-text-4" id="text-org5e02738">
<blockquote>
<p>
Performs 18 `remainder' operations
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-org219a962" class="outline-3">
<h3 id="org219a962">1.21</h3>
<div class="outline-text-3" id="text-org219a962">
<p class="verse">
Use the smallest-divisor procedure to find the smallest divisor of each of<br>
the following numbers: 199, 1999, 19999.<br>
</p>
</div>

<div id="outline-container-orgf3fc63a" class="outline-4">
<h4 id="orgf3fc63a">Answer</h4>
<div class="outline-text-4" id="text-orgf3fc63a">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">divides?</span> a b<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>= <span style="color: #268bd2;">(</span>remainder b a<span style="color: #268bd2;">)</span> <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">find-divisor</span> n test-divisor<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">cond</span> <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span>&gt; <span style="color: #859900;">(</span>square test-divisor<span style="color: #859900;">)</span> n<span style="color: #6c71c4;">)</span> n<span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span>divides? test-divisor n<span style="color: #6c71c4;">)</span> test-divisor<span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">else</span> <span style="color: #6c71c4;">(</span>find-divisor n <span style="color: #859900;">(</span>+ test-divisor <span style="color: #6c71c4;">1</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">smallest-divisor</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>find-divisor n <span style="color: #6c71c4;">2</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #93a1a1;">;; </span><span style="color: #cc9393;">TODO</span><span style="color: #93a1a1;"> </span><span style="color: #cc9393;">XXX</span><span style="color: #93a1a1;"> write test</span>
<span style="color: #93a1a1;">;; </span><span style="color: #93a1a1;">(format #f "~a" (for-each smallest-divisor '(199 1999 1999)))</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org6f7ab1b" class="outline-3">
<h3 id="org6f7ab1b">1.22</h3>
<div class="outline-text-3" id="text-org6f7ab1b">
<p class="verse">
Most Lisp implementations include a primitive called `runtime' that returns<br>
an integer that specifies the amount of time the system has been running<br>
(measured, for quote, in microseconds). The following `timed-prime-test'<br>
procedure, when called with an integer n, prints n and checks to see if n<br>
is prime. If n is prime, the procedure prints three asterisks followed by<br>
the amount of time used in performing the test.<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (timed-prime-test n)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(newline)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(display n)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(start-prime-test n (current-time)))<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (start-prime-test n start-time)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(if (prime? n)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(report-prime (- (current-time) start-time))))<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (report-prime elapsed-time)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(display " <b>*</b> ")<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(display elapsed-time)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#t)<br>
<br>
Using this procedure, write a procedure `search-for-primes' that<br>
checks the primality of consecutive odd integers in a specified range. Use<br>
your procedure to find the three smallest primes larger than 1000; larger<br>
than 10,000; larger than 100,000; larger than 1,000,000. Note the time<br>
needed to test each prime. Since the testing algorithm has order of growth<br>
of [theta](_[sqrt]<sub>(n)</sub>), you should expect that testing for primes around<br>
10,000 should take about _[sqrt]<sub>(10)</sub> times as long as testing for primes<br>
around 1000. Do your timing data bear this out? How well do the data for<br>
100,000 and 1,000,000 support the _[sqrt]<sub>(n)</sub> prediction? Is your result<br>
compatible with the notion that programs on your machine run in time<br>
proportional to the number of steps required for the computation?<br>
</p>
</div>

<div id="outline-container-orgdf08161" class="outline-4">
<h4 id="orgdf08161">Answer</h4>
<div class="outline-text-4" id="text-orgdf08161">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">prime?</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>= n <span style="color: #268bd2;">(</span>smallest-divisor n<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">expmod</span> base exp m<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">cond</span> <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span>= exp <span style="color: #6c71c4;">0</span><span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span>even? exp<span style="color: #6c71c4;">)</span>
         <span style="color: #6c71c4;">(</span>remainder
          <span style="color: #859900;">(</span>square <span style="color: #b58900;">(</span>expmod base <span style="color: #268bd2;">(</span>/ exp <span style="color: #6c71c4;">2</span><span style="color: #268bd2;">)</span> m<span style="color: #b58900;">)</span><span style="color: #859900;">)</span>
          m<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">else</span>
         <span style="color: #6c71c4;">(</span>remainder
          <span style="color: #859900;">(</span>* base <span style="color: #b58900;">(</span>expmod base <span style="color: #268bd2;">(</span>- exp <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span> m<span style="color: #b58900;">)</span><span style="color: #859900;">)</span>
          m<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">search-for-primes</span> start<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">is-prime?</span> n<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">cond</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900;">(</span>even? n<span style="color: #859900;">)</span> #f<span style="color: #6c71c4;">]</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900;">(</span>&lt; n <span style="color: #6c71c4;">0</span><span style="color: #859900;">)</span> #f<span style="color: #6c71c4;">]</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900;">(</span>timed-prime-test n<span style="color: #859900;">)</span> #t<span style="color: #6c71c4;">]</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900; font-weight: bold;">else</span> <span style="color: #859900;">(</span>is-prime? <span style="color: #b58900;">(</span>- n <span style="color: #6c71c4;">2</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">driver</span> n primes count<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">cond</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900;">(</span>even? n<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>driver <span style="color: #b58900;">(</span>+ n <span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span> primes count<span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900;">(</span>= count <span style="color: #6c71c4;">3</span><span style="color: #859900;">)</span> primes<span style="color: #6c71c4;">]</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900;">(</span>is-prime? n<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>driver <span style="color: #b58900;">(</span>+ n <span style="color: #6c71c4;">2</span><span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>cons n primes<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>+ count <span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span>
     <span style="color: #6c71c4;">[</span><span style="color: #859900; font-weight: bold;">else</span> <span style="color: #859900;">(</span>driver <span style="color: #b58900;">(</span>+ n <span style="color: #6c71c4;">2</span><span style="color: #b58900;">)</span> primes count<span style="color: #859900;">)</span><span style="color: #6c71c4;">]</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

  <span style="color: #b58900;">(</span>driver start '<span style="color: #268bd2;">()</span> <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org34d9936" class="outline-3">
<h3 id="org34d9936">1.23</h3>
<div class="outline-text-3" id="text-org34d9936">
<p class="verse">
The `smallest-divisor' procedure shown at the start of this section does<br>
lots of needless testing: After it checks to see if the number is divisible<br>
by 2 there is no point in checking to see if it is divisible by any larger<br>
even numbers. This suggests that the values used for `test-divisor' should<br>
not be 2, 3, 4, 5, 6, &#x2026;, but rather 2, 3, 5, 7, 9, &#x2026;. To implement this<br>
change, define a procedure `next' that returns 3 if its input is equal to 2<br>
and otherwise returns its input plus 2. Modify the `smallest-divisor'<br>
procedure to use `(next test-divisor)' instead of `(+ test-divisor 1)'.<br>
With `timed-prime-test' incorporating this modified version of<br>
`smallest-divisor', run the test for each of the 12 primes found Note in 1.22<br>
Since this modification halves the number of test steps, you should expect<br>
it to run about twice as fast. Is this expectation confirmed? If not, what<br>
is the observed ratio of the speeds of the two algorithms, and how do you<br>
explain the fact that it is different from 2?<br>
</p>
</div>

<div id="outline-container-orgceb6a0b" class="outline-4">
<h4 id="orgceb6a0b">Answer</h4>
<div class="outline-text-4" id="text-orgceb6a0b">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.23/next</span> n<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>= n <span style="color: #6c71c4;">2</span><span style="color: #268bd2;">)</span> <span style="color: #6c71c4;">3</span> <span style="color: #268bd2;">(</span>+ n <span style="color: #6c71c4;">2</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga1068b7" class="outline-3">
<h3 id="orga1068b7">1.24</h3>
<div class="outline-text-3" id="text-orga1068b7">
</div>
<div id="outline-container-org2c4a385" class="outline-4">
<h4 id="org2c4a385">Answer</h4>
</div>
</div>
<div id="outline-container-orge02cf74" class="outline-3">
<h3 id="orge02cf74">1.25</h3>
<div class="outline-text-3" id="text-orge02cf74">
<p class="verse">
Alyssa P. Hacker complains that we went to a lot of extra work in writing<br>
`expmod'. After all, she says, since we already know how to compute<br>
exponentials, we could have simply written<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (expmod base exp m)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(remainder (fast-expt base exp) m))<br>
<br>
Is she correct? Would this procedure serve as well for our fast prime<br>
tester? Explain.<br>
</p>
</div>

<div id="outline-container-orgf47ba51" class="outline-4">
<h4 id="orgf47ba51">Answer</h4>
<div class="outline-text-4" id="text-orgf47ba51">
<blockquote>
<p>
Depending on the behavior of large values of `base' and `exp' combined with
the system's handling of large numbers, it is either a middling gain or an
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-orgdbe2f1e" class="outline-3">
<h3 id="orgdbe2f1e">1.26</h3>
<div class="outline-text-3" id="text-orgdbe2f1e">
<p class="verse">
Louis Reasoner is having great difficulty doing *Note Exercise 1.24. His<br>
`fast-prime?' test seems to run more slowly than his `prime?' test. Louis<br>
calls his friend Eva Lu Ator over to help. When they examine Louis's code,<br>
they find that he has rewritten the `expmod' procedure to use an explicit<br>
multiplication, rather than calling `square':<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (expmod base exp m)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(cond ((= exp 0) 1)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;((even? exp)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(remainder (* (expmod base (/ exp 2) m)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(expmod base (/ exp 2) m))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;m))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(else<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(remainder (* base (expmod base (- exp 1) m))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;m))))<br>
<br>
"I don't see what difference that could make," says Louis. "I do."<br>
says Eva. "By writing the procedure like that, you have transformed the<br>
[theta](`log' n) process into a [theta](n) process." Explain.<br>
</p>
</div>

<div id="outline-container-org4c66f00" class="outline-4">
<h4 id="org4c66f00">Answer</h4>
<div class="outline-text-4" id="text-org4c66f00">
<blockquote>
<p>
Assuming the computer doesn't perform any sort of sophisticated
memoization, effectively each step is performing twice as much work for n
steps, e.g n<sup>2</sup>, trimming the speed of the original implementation down to
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-orgb2c7a9d" class="outline-3">
<h3 id="orgb2c7a9d">1.27</h3>
<div class="outline-text-3" id="text-orgb2c7a9d">
</div>
<div id="outline-container-org8fb539f" class="outline-4">
<h4 id="org8fb539f">Answer</h4>
</div>
</div>
<div id="outline-container-org08785c9" class="outline-3">
<h3 id="org08785c9">1.28</h3>
<div class="outline-text-3" id="text-org08785c9">
</div>
<div id="outline-container-org6a5919a" class="outline-4">
<h4 id="org6a5919a">Answer</h4>
</div>
</div>
<div id="outline-container-org3d0aa43" class="outline-3">
<h3 id="org3d0aa43">1.30</h3>
<div class="outline-text-3" id="text-org3d0aa43">
<p class="verse">
The sum procedure above generates a linear recursion. The procedure can be<br>
rewritten so that the sum is performed iteratively.<br>
</p>
</div>

<div id="outline-container-orgecc4516" class="outline-4">
<h4 id="orgecc4516">Answer</h4>
<div class="outline-text-4" id="text-orgecc4516">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.30/sum</span> term a next b<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">iter</span> a result<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>&gt; a b<span style="color: #6c71c4;">)</span>
        result
        <span style="color: #6c71c4;">(</span>iter <span style="color: #859900;">(</span>next a<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>+ <span style="color: #b58900;">(</span>term a<span style="color: #b58900;">)</span> result<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

  <span style="color: #b58900;">(</span>iter a <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9dc066a" class="outline-3">
<h3 id="org9dc066a">1.31</h3>
<div class="outline-text-3" id="text-org9dc066a">
<p class="verse">
1. The `sum' procedure is only the simplest of a vast number of similar<br>
abstractions that can be captured as higher-order procedures. Write an<br>
analogous procedure called product that returns the product of the values<br>
of a function at points over a given range. Show how to define factorial in<br>
terms of product. Also use product to compute approximations to π using the<br>
formula:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;π/4 = 2/3 ⋅ 4/3 ⋅ 4/5 ⋅ 6/5 ⋅ 6/7 ⋅ 8/7<br>
<br>
2. If your product procedure generates a recursive process, write one that<br>
generates an iterative process. If it generates an iterative process, write<br>
one that generates a recursive process.<br>
</p>
</div>

<div id="outline-container-org03b4ee1" class="outline-4">
<h4 id="org03b4ee1">Answer</h4>
<div class="outline-text-4" id="text-org03b4ee1">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">recursive-product</span> term a next b<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>&gt; a b<span style="color: #268bd2;">)</span> a<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>* <span style="color: #268bd2;">(</span>term a<span style="color: #268bd2;">)</span>
     <span style="color: #268bd2;">(</span>recursive-product term <span style="color: #6c71c4;">(</span>next a<span style="color: #6c71c4;">)</span> next b<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">iterative-product</span> term a next b<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">iter</span> a result<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>&gt; a b<span style="color: #6c71c4;">)</span>
        result
        <span style="color: #6c71c4;">(</span>iter <span style="color: #859900;">(</span>next a<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>* <span style="color: #b58900;">(</span>term a<span style="color: #b58900;">)</span> result<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

  <span style="color: #b58900;">(</span>iter a <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.31/factorial</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>zero? n<span style="color: #268bd2;">)</span> <span style="color: #6c71c4;">1</span>
      <span style="color: #268bd2;">(</span>iterative-product identity <span style="color: #6c71c4;">1</span> inc n<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.31/pi-approximate</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">fnth</span> nth<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>even? nth<span style="color: #6c71c4;">)</span>
        <span style="color: #6c71c4;">(</span>/ <span style="color: #859900;">(</span>double nth<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>inc <span style="color: #b58900;">(</span>double nth<span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span>
        <span style="color: #6c71c4;">(</span>/ <span style="color: #859900;">(</span>inc <span style="color: #b58900;">(</span>double nth<span style="color: #b58900;">)</span><span style="color: #859900;">)</span> <span style="color: #859900;">(</span>double nth<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

  <span style="color: #b58900;">(</span>* <span style="color: #6c71c4;">4.0</span> <span style="color: #268bd2;">(</span>iterative-product fnth <span style="color: #6c71c4;">0</span> inc n<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf9f42eb" class="outline-3">
<h3 id="orgf9f42eb">1.32</h3>
<div class="outline-text-3" id="text-orgf9f42eb">
<p class="verse">
1. Show that sum and product (Exercise 1.31) are both special cases of a still<br>
more general notion called accumulate that combines a collection of terms,<br>
using some general accumulation function:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(accumulate<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;combiner null-value term a next b)<br>
<br>
Accumulate takes as arguments the same term and range specifications as sum<br>
and product, together with a combiner procedure (of two arguments) that<br>
specifies how the current term is to be combined with the accumulation of<br>
the preceding terms and a null-value that specifies what base value to use<br>
when the terms run out. Write accumulate and show how sum and product can<br>
both be defined as simple calls to accumulate.<br>
<br>
2. If your accumulate procedure generates a recursive process, write one<br>
that generates an iterative process. If it generates an iterative process,<br>
write one that generates a recursive process.<br>
</p>
</div>

<div id="outline-container-org83e77e3" class="outline-4">
<h4 id="org83e77e3">Answer</h4>
<div class="outline-text-4" id="text-org83e77e3">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.32/recursive-accumulate</span> combiner null term a next b<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>&gt; a b<span style="color: #268bd2;">)</span> a
      <span style="color: #268bd2;">(</span>combiner <span style="color: #6c71c4;">(</span>term a<span style="color: #6c71c4;">)</span>
                <span style="color: #6c71c4;">(</span>1.32/recursive-accumulate combiner null term <span style="color: #859900;">(</span>next a<span style="color: #859900;">)</span> next b<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.32/iterative-accumulate</span> combiner null term a next b<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">fold-left</span> n acc<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>&gt; n b<span style="color: #6c71c4;">)</span> acc
        <span style="color: #6c71c4;">(</span>fold-left <span style="color: #859900;">(</span>next n<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>combiner <span style="color: #b58900;">(</span>term n<span style="color: #b58900;">)</span> acc<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>fold-left a null<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #93a1a1;">;; </span><span style="color: #cc9393;">XXX</span><span style="color: #93a1a1;">: add to test</span>
<span style="color: #93a1a1;">;; </span><span style="color: #93a1a1;">(1.32/iterative-accumulate * 1 identity 1 inc 5) =&gt; 120</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org2dc6a14" class="outline-3">
<h3 id="org2dc6a14">1.33</h3>
<div class="outline-text-3" id="text-org2dc6a14">
<p class="verse">
You can obtain an even more general version of accumulate (Exercise 1.32)<br>
by introducing the notion of a filter on the terms to be combined. That is,<br>
combine only those terms derived from values in the range that satisfy a<br>
specified condition. The resulting `filtered-accumulate' abstraction takes<br>
the same arguments as `accumulate', together with an additional predicate of<br>
one argument that specifies the filter. Write `filtered-accumulate' as a<br>
procedure. Show how to express the following using `filtered-accumulate':<br>
<br>
1. the sum of the squares of the prime numbers in the interval a to b<br>
(assuming that you have a prime? predicate already written)<br>
<br>
2. the product of all the positive integers less than n that are relatively<br>
prime to n (i.e., all positive integers i &lt; n such that GCD (i, n) = 1).<br>
</p>
</div>

<div id="outline-container-orgf391033" class="outline-4">
<h4 id="orgf391033">Answer</h4>
<div class="outline-text-4" id="text-orgf391033">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.33/filtered-accumulate</span> combiner null term a next b filter<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>&gt; a b<span style="color: #268bd2;">)</span> null
      <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>filter a<span style="color: #6c71c4;">)</span>
          <span style="color: #6c71c4;">(</span>combiner <span style="color: #859900;">(</span>term a<span style="color: #859900;">)</span>
                    <span style="color: #859900;">(</span>1.33/filtered-accumulate combiner null term <span style="color: #b58900;">(</span>next a<span style="color: #b58900;">)</span> next b filter<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span>
          <span style="color: #6c71c4;">(</span>1.33/filtered-accumulate combiner null term <span style="color: #859900;">(</span>next a<span style="color: #859900;">)</span> next b filter<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.33/sum-of-prime-squares</span> a b<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>1.33/filtered-accumulate + <span style="color: #6c71c4;">0</span> square a inc b prime?<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.33/coprimes</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>1.33/filtered-accumulate * <span style="color: #6c71c4;">1</span> identity <span style="color: #6c71c4;">1</span> inc n <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>i<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>= <span style="color: #6c71c4;">1</span> <span style="color: #859900;">(</span>gcd i n<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org29095cf" class="outline-3">
<h3 id="org29095cf">1.34</h3>
<div class="outline-text-3" id="text-org29095cf">
<p class="verse">
Suppose we define the procedure<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(define (f g) (g 2))<br>
<br>
Then we have<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(f square)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;4<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(f (lambda (z) (* z (+ z 1))))<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;6<br>
<br>
What happens if we (perversely) ask the interpreter to evaluate the<br>
combination (f f)?<br>
<br>
Explain.<br>
</p>
</div>

<div id="outline-container-org3c5b418" class="outline-4">
<h4 id="org3c5b418">Answer</h4>
<div class="outline-text-4" id="text-org3c5b418">
<p class="verse">
<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org62bcdbd" class="outline-3">
<h3 id="org62bcdbd">1.35</h3>
<div class="outline-text-3" id="text-org62bcdbd">
<p class="verse">
Show that the golden ratio φ (1.2.2) is a fixed point of the transformation<br>
x↦1+1/x, and use this fact to compute φ by means of the fixed-point<br>
procedure.<br>
</p>
</div>

<div id="outline-container-orgda56077" class="outline-4">
<h4 id="orgda56077">Answer</h4>
<div class="outline-text-4" id="text-orgda56077">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.35/find-golden-ratio</span><span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>fixed-point <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>n<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>+ <span style="color: #6c71c4;">1</span> <span style="color: #859900;">(</span>/ <span style="color: #6c71c4;">1</span> n<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span> <span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge8db704" class="outline-3">
<h3 id="orge8db704">1.36</h3>
<div class="outline-text-3" id="text-orge8db704">
</div>
<div id="outline-container-orgecf8822" class="outline-4">
<h4 id="orgecf8822">Answer</h4>
</div>
</div>
<div id="outline-container-orgcd5f630" class="outline-3">
<h3 id="orgcd5f630">1.37</h3>
<div class="outline-text-3" id="text-orgcd5f630">
<p class="verse">
a. An infinite "continued fraction" is an expression of the form<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;N<sub>1</sub><br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;f = ----------------&#x2013;&#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;N<sub>2</sub><br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;D<sub>1</sub> + ----------&#x2013;&#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;N<sub>3</sub><br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;D<sub>2</sub> + ----&#x2013;&#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;D<sub>3</sub> + &#x2026;<br>
<br>
&#xa0;&#xa0;As an quote, one can show that the infinite continued<br>
&#xa0;&#xa0;fraction expansion with the Nᵢ and the Dᵢ all equal to 1<br>
&#xa0;&#xa0;produces 1/φ, where φ is the golden ratio (described<br>
&#xa0;&#xa0;in section *Note 1.2.2).  One way to approximate an<br>
&#xa0;&#xa0;infinite continued fraction is to truncate the expansion<br>
&#xa0;&#xa0;after a given number of terms.  Such a truncation&#x2013;a<br>
&#xa0;&#xa0;so-called finite continued fraction "k-term finite continued<br>
&#xa0;&#xa0;fraction"&#x2013;has the form<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;N<sub>1</sub><br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;------------&#x2013;&#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;N<sub>2</sub><br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;D<sub>1</sub> + ------&#x2013;&#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#x2026;    N<sub>K</sub><br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;+ &#x2013;&#x2014;<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;D<sub>K</sub><br>
<br>
&#xa0;&#xa0;Suppose that `n' and `d' are procedures of one argument (the<br>
&#xa0;&#xa0;term index i) that return the Nᵢ and Dᵢ of the terms of the<br>
&#xa0;&#xa0;continued fraction.  Define a procedure `cont-frac' such that<br>
&#xa0;&#xa0;evaluating `(cont-frac n d k)' computes the value of the<br>
&#xa0;&#xa0;k-term finite continued fraction.  Check your procedure by<br>
&#xa0;&#xa0;approximating 1/φ using<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(cont-frac (lambda (i) 1.0)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;(lambda (i) 1.0)<br>
&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;k)<br>
<br>
&#xa0;&#xa0;for successive values of `k'.  How large must you make `k' in<br>
&#xa0;&#xa0;order to get an approximation that is accurate to 4 decimal<br>
&#xa0;&#xa0;places?<br>
<br>
b. If your `cont-frac' procedure generates a recursive process,<br>
&#xa0;&#xa0;write one that generates an iterative process.  If it<br>
&#xa0;&#xa0;generates an iterative process, write one that generates a<br>
&#xa0;&#xa0;recursive process.<br>
</p>
</div>

<div id="outline-container-org4cc0c27" class="outline-4">
<h4 id="org4cc0c27">Answer</h4>
<div class="outline-text-4" id="text-org4cc0c27">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.37/cont-frac-recursive</span> n d kth<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">nth-continuation</span> nth<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>&gt; nth kth<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>d nth<span style="color: #6c71c4;">)</span>
        <span style="color: #6c71c4;">(</span>/ <span style="color: #859900;">(</span>n nth<span style="color: #859900;">)</span>
           <span style="color: #859900;">(</span>+ <span style="color: #b58900;">(</span>d nth<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>nth-continuation <span style="color: #268bd2;">(</span>inc nth<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>nth-continuation <span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.37/cont-frac-iter</span> n d kth<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">(</span><span style="color: #268bd2;">nth-continuation</span> nth acc<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>&gt; nth kth<span style="color: #6c71c4;">)</span> acc
        <span style="color: #6c71c4;">(</span>nth-continuation <span style="color: #859900;">(</span>inc nth<span style="color: #859900;">)</span>
                          <span style="color: #859900;">(</span>/ <span style="color: #b58900;">(</span>n nth<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span>+ <span style="color: #268bd2;">(</span>d nth<span style="color: #268bd2;">)</span> acc<span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>nth-continuation <span style="color: #6c71c4;">1</span> <span style="color: #6c71c4;">0</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #268bd2;">cont-frac</span> 1.37/cont-frac-iter<span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org163dec8" class="outline-3">
<h3 id="org163dec8">1.38</h3>
<div class="outline-text-3" id="text-org163dec8">
<p class="verse">
In 1737, the Swiss mathematician Leonhard Euler published a memoir `De<br>
Fractionibus Continuis', which included a continued fraction expansion for<br>
e - 2, where e is the base of the natural logarithms. In this fraction, the<br>
nᵢ are all 1, and the Dᵢ are successively 1, 2, 1, 1, 4, 1, 1, 6, 1, 1,<br>
8, &#x2026;. Write a program that uses your `cont-frac' procedure from Exercise<br>
1.37 to approximate e, based on Euler's expansion.<br>
</p>
</div>

<div id="outline-container-org2015806" class="outline-4">
<h4 id="org2015806">Answer</h4>
<div class="outline-text-4" id="text-org2015806">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">e-2</span> k<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>cont-frac
   <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>i<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">1.0</span><span style="color: #268bd2;">)</span>
   <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>n<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #859900;">(</span>= <span style="color: #6c71c4;">0</span> <span style="color: #b58900;">(</span>modulo <span style="color: #268bd2;">(</span>+ n <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span> <span style="color: #6c71c4;">3</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span>
              <span style="color: #859900;">(</span>* <span style="color: #6c71c4;">2</span> <span style="color: #b58900;">(</span>/ <span style="color: #268bd2;">(</span>+ n <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span> <span style="color: #6c71c4;">3</span><span style="color: #b58900;">)</span><span style="color: #859900;">)</span>
              <span style="color: #6c71c4;">1</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
   k<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org06394c4" class="outline-3">
<h3 id="org06394c4">1.39</h3>
<div class="outline-text-3" id="text-org06394c4">
<p class="verse">
A continued fraction representation of the<br>
tangent function was published in 1770 by the German mathematician<br>
J.H. Lambert:<br>
<br>
x<br>
tan x = ----------&#x2013;&#x2014;<br>
x<sup>2</sup><br>
1 - ------&#x2013;&#x2014;<br>
x<sup>2</sup><br>
3 - --&#x2013;&#x2014;<br>
5  - &#x2026;<br>
<br>
where x is in radians.  Define a procedure `(tan-cf x k)' that<br>
computes an approximation to the tangent function based on<br>
Lambert's formula.  `K' specifies the number of terms to compute,<br>
as in *Note Exercise 1.37<br>
</p>
</div>

<div id="outline-container-orgf423c11" class="outline-4">
<h4 id="orgf423c11">Answer</h4>
<div class="outline-text-4" id="text-orgf423c11">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.39/tan-cf</span> x k<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>cont-frac <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>i<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #859900;">(</span>= i <span style="color: #6c71c4;">1</span><span style="color: #859900;">)</span> x <span style="color: #859900;">(</span>* <span style="color: #6c71c4;">-1.0</span> <span style="color: #b58900;">(</span>* x x<span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
             <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>i<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>- <span style="color: #859900;">(</span>* i <span style="color: #6c71c4;">2</span><span style="color: #859900;">)</span> <span style="color: #6c71c4;">1.0</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
             k<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org4c838f0" class="outline-3">
<h3 id="org4c838f0">1.40</h3>
<div class="outline-text-3" id="text-org4c838f0">
<p class="verse">
Define a procedure cubic that can be used together with the newtons-method<br>
procedure in expressions of the form<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;(newtons-method (cubic a b c) 1)<br>
<br>
to approximate zeros of the cubic x³+ax²+bx+c.<br>
</p>
</div>

<div id="outline-container-org81e57cc" class="outline-4">
<h4 id="org81e57cc">Answer</h4>
<div class="outline-text-4" id="text-org81e57cc">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">cubic</span> a b c<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #268bd2;">(</span>x<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span>+ <span style="color: #6c71c4;">(</span>* x x x<span style="color: #6c71c4;">)</span>
       <span style="color: #6c71c4;">(</span>* a <span style="color: #859900;">(</span>* x x<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span>
       <span style="color: #6c71c4;">(</span>* b x<span style="color: #6c71c4;">)</span>
       c<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org6c75317" class="outline-3">
<h3 id="org6c75317">1.41</h3>
<div class="outline-text-3" id="text-org6c75317">
<p class="verse">
Define a procedure double that takes a procedure of one argument as<br>
argument and returns a procedure that applies the original procedure twice.<br>
For quote, if inc is a procedure that adds 1 to its argument, then<br>
(double inc) should be a procedure that adds 2. What value is returned by<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;(((double (double double)) inc) 5)<br>
<br>
?<br>
</p>
</div>

<div id="outline-container-org63adab4" class="outline-4">
<h4 id="org63adab4">Answer</h4>
<div class="outline-text-4" id="text-org63adab4">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.41/double</span> fn<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #268bd2;">(</span>n<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>fn <span style="color: #6c71c4;">(</span>fn n<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge79b8d2" class="outline-3">
<h3 id="orge79b8d2">1.42</h3>
<div class="outline-text-3" id="text-orge79b8d2">
<p class="verse">
Let f and g be two one-argument functions. The composition f after g is<br>
defined to be the function x↦f(g(x)). Define a procedure compose that<br>
implements composition. For quote, if inc is a procedure that adds 1 to<br>
its argument,<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;((compose square inc) 6)<br>
&#xa0;&#xa0;&#xa0;&#xa0;49<br>
</p>
</div>

<div id="outline-container-org2fbca79" class="outline-4">
<h4 id="org2fbca79">Answer</h4>
<div class="outline-text-4" id="text-org2fbca79">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.42/compose</span> f g<span style="color: #b58900;">)</span> <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #268bd2;">(</span>n<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>f <span style="color: #6c71c4;">(</span>g n<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org5e6557b" class="outline-3">
<h3 id="org5e6557b">1.43</h3>
<div class="outline-text-3" id="text-org5e6557b">
<p class="verse">
If f is a numerical function and n is a positive integer, then we can form<br>
the nth repeated application of f, which is defined to be the function<br>
whose value at x is f(f(…(f(x))…)). For quote, if f is the function<br>
x↦x+1, then the nth repeated application of f is the function x↦x+n. If f<br>
is the operation of squaring a number, then the nth repeated application of<br>
f is the function that raises its argument to the 2n-th power. Write a<br>
procedure that takes as inputs a procedure that computes f and a positive<br>
integer n and returns the procedure that computes the nth repeated<br>
application of f. Your procedure should be able to be used as follows:<br>
<br>
&#xa0;&#xa0;&#xa0;&#xa0;((repeated square 2) 5)<br>
&#xa0;&#xa0;&#xa0;&#xa0;625<br>
<br>
Hint: You may find it convenient to use compose from Exercise 1.42.<br>
</p>
</div>

<div id="outline-container-orge0659f8" class="outline-4">
<h4 id="orge0659f8">Answer</h4>
<div class="outline-text-4" id="text-orge0659f8">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.43/repeated-apply</span> fn times<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>= times <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>n<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>fn n<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
      <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>n<span style="color: #6c71c4;">)</span>
        <span style="color: #6c71c4;">(</span>fn
         <span style="color: #859900;">(</span><span style="color: #b58900;">(</span>1.43/repeated-apply fn <span style="color: #268bd2;">(</span>- times <span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span> n<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb04ad84" class="outline-3">
<h3 id="orgb04ad84">1.44</h3>
<div class="outline-text-3" id="text-orgb04ad84">
<p class="verse">
The idea of smoothing a function is an important concept in signal<br>
processing. If f is a function and dx is some small number, then the<br>
smoothed version of f is the function whose value at a point x is the<br>
average of f(x−dx), f(x), and f(x+dx). Write a procedure smooth that takes<br>
as input a procedure that computes f and returns a procedure that computes<br>
the smoothed f. It is sometimes valuable to repeatedly smooth a function<br>
(that is, smooth the smoothed function, and so on) to obtain the n-fold<br>
smoothed function. Show how to generate the n-fold smoothed function of any<br>
given function using smooth and repeated from Exercise 1.43.<br>
</p>
</div>

<div id="outline-container-orgcfa7a7b" class="outline-4">
<h4 id="orgcfa7a7b">Answer</h4>
<div class="outline-text-4" id="text-orgcfa7a7b">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.44/smooth</span> f<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #268bd2;">(</span>x<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span>/ <span style="color: #6c71c4;">(</span>+ <span style="color: #859900;">(</span>f <span style="color: #b58900;">(</span>- x dx<span style="color: #b58900;">)</span><span style="color: #859900;">)</span>
          <span style="color: #859900;">(</span>f x<span style="color: #859900;">)</span>
          <span style="color: #859900;">(</span>f <span style="color: #b58900;">(</span>+ x dx<span style="color: #b58900;">)</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span>
       <span style="color: #6c71c4;">3</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org238e0d9" class="outline-3">
<h3 id="org238e0d9">1.45</h3>
<div class="outline-text-3" id="text-org238e0d9">
</div>
<div id="outline-container-org55db118" class="outline-4">
<h4 id="org55db118">Answer</h4>
</div>
</div>
<div id="outline-container-org28913c3" class="outline-3">
<h3 id="org28913c3">1.46</h3>
<div class="outline-text-3" id="text-org28913c3">
<p class="verse">
Several of the numerical methods described in this chapter are instances of<br>
an extremely general computational strategy known as iterative improvement.<br>
Iterative improvement says that, to compute something, we start with an<br>
initial guess for the answer, test if the guess is good enough, and<br>
otherwise improve the guess and continue the process using the improved<br>
guess as the new guess. Write a procedure iterative-improve that takes two<br>
procedures as arguments: a method for telling whether a guess is good<br>
enough and a method for improving a guess. Iterative-improve should return<br>
as its value a procedure that takes a guess as argument and keeps improving<br>
the guess until it is good enough. Rewrite the sqrt procedure of 1.1.7 and<br>
the fixed-point procedure of 1.3.3 in terms of iterative-improve.<br>
</p>
</div>

<div id="outline-container-orge68d787" class="outline-4">
<h4 id="orge68d787">Answer</h4>
<div class="outline-text-4" id="text-orge68d787">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">iterative-improve</span> good-enough? improve<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #268bd2;">(</span>guess<span style="color: #268bd2;">)</span>
    <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #6c71c4;">(</span><span style="color: #859900;">[</span>improved <span style="color: #b58900;">(</span>improve guess<span style="color: #b58900;">)</span><span style="color: #859900;">]</span><span style="color: #6c71c4;">)</span>
      <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #859900;">(</span>good-enough? guess improved<span style="color: #859900;">)</span> guess
          <span style="color: #859900;">(</span><span style="color: #b58900;">(</span>iterative-improve good-enough? improve<span style="color: #b58900;">)</span> improved<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.46/iterative-sqrt</span> n<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span>iterative-improve
   <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>guess improved<span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>&lt; <span style="color: #859900;">(</span>abs <span style="color: #b58900;">(</span>- guess improved<span style="color: #b58900;">)</span><span style="color: #859900;">)</span> <span style="color: #6c71c4;">0.001</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
   <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #6c71c4;">(</span>guess<span style="color: #6c71c4;">)</span>
     <span style="color: #6c71c4;">(</span>average guess <span style="color: #859900;">(</span>/ n guess<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">define</span> <span style="color: #b58900;">(</span><span style="color: #268bd2;">1.46/fixed-point</span> f first-guess<span style="color: #b58900;">)</span>
  <span style="color: #b58900;">(</span><span style="color: #268bd2;">(</span>iterative-improve
    <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #859900;">(</span>guess<span style="color: #859900;">)</span>
      <span style="color: #859900;">(</span>&lt; <span style="color: #b58900;">(</span>abs <span style="color: #268bd2;">(</span>- <span style="color: #6c71c4;">(</span>f guess<span style="color: #6c71c4;">)</span> guess<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
         <span style="color: #6c71c4;">0.00001</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span>
    <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">&#955;</span> <span style="color: #859900;">(</span>guess<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>f guess<span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
   first-guess<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>
</div>
</section>
